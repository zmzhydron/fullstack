<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>22</title>
    <script src="./tools/axios.min.js"></script>
    <style>
        .register {
            border: solid 2px pink;
            padding: 30px;
        }

        .loginctn {
            border: dashed 2px red;
            padding: 30px;
        }

        .updateCTn {
            border: dashed 2px green;
            padding: 30px;
        }

        .search {
            border: dashed 2px purple;
            padding: 30px;
            font-size: 24px;
        }

        #bigpptpt {
            width: 800px;
        }
    </style>
</head>

<body>
    <h1 id="currentUser"></h1>
    <div class="register">
        <input type="text" value="" id="loginid" placeholder="id" />
        <input type="text" value="" id="loginpassword" placeholder="password" />
        <button id="register">register1</button>
    </div>
    <div class="loginctn">
        <input type="text" value="zmz" id="id" placeholder="id" />
        <input type="text" value="123456" id="password" placeholder="password" />
        <button id="login">login</button>
    </div>
    <!-- <div id="aaaaaaaa"></div>
    <div class="search">
        <input type="text" value="" id="searchname" placeholder="id" />
        <input type="text" value="" id="searchvalue" placeholder="password" />
        <button id="search">search</button>
    </div> -->
    <div class="updateCTn">
        <input type="file" multiple=true id="uperdaasd">
        <button id="getphoto">getphoto</button>
    </div>
    <img src="" id="ImagePic" />
    <div id="app"></div>
    <button id="load">load</button>
</body>
<script>
    window.onload = function () {
        let register = document.getElementById("register");
        register.onclick = function () {
            axios.post("/api/register", {
                name: document.getElementById('loginid').value,
                password: document.getElementById('loginpassword').value,
            }).then(val => {
                console.log(val);
            })
        }
        // let search = document.getElementById("search");
        // search.onclick = function () {
        //     axios.post("/api/search", {
        //         searchname: document.getElementById('searchname').value,
        //         searchvalue: document.getElementById('searchvalue').value,
        //     }).then(val => {
        //         console.log(val);
        //     })
        // }
        // let world = document.getElementById("world");
        // world.onclick = function () {
        //     axios.get("/api/world/hello").then(val => {
        //         console.log(val);
        //     })
        // }
        // let aaa = document.getElementById("aaa");
        // aaa.onclick = function () {
        //     console.log("@@@@@@@@@@");
        //     axios.get("/api/fuckyou").then(val => {
        //         console.log(val);
        //     })
        // }
        // let bbb = document.getElementById("bbb");
        // bbb.onclick = function () {
        //     axios.get("/api/doggy").then(val => {
        //         let { name, password } = val.data;
        //         document.getElementById("aaaaaaaa").innerHTML = `<h1>${name}, password${password}</h1>`;
        //     })
        // }
        let login = document.getElementById("login");
        let loginfn = function () {
            axios.post("/api/login", {
                name: document.getElementById('id').value,
                password: document.getElementById('password').value,
            }).then(val => {
                let data = val.data;
                document.getElementById("currentUser").innerHTML = data.name + " adddate: " + data.addDate;
            })
        }
        login.onclick = loginfn;
        setTimeout(loginfn, 300);
        let uperdaasd = document.getElementById("uperdaasd");
        uperdaasd.onchange = function (e) {
            // let file = e.target.files[0];
            // console.log(e.target.files);
            // let blob = new Blob([file]);
            // let src = URL.createObjectURL(blob);
            // document.getElementById('ImagePic').src = src;
            var obj = new FormData();
            console.log(e.target.files);
            for (let value of e.target.files) {
                obj.append("photos", value);
            }
            axios.post('/api/upload', obj, {
                headers: { "Content-Type": "multipart/form-data" },
                // responseType: 'blob'
            }).then(val => {
                // var src = URL.createObjectURL(val.data);
                // document.getElementById('ImagePic').src = src;
                // uperdaasd.value = '';
            })
        }
        let getphoto = document.getElementById("getphoto");
        getphoto.onclick = function () {
            // axios.post("/api/world/getphoto", {}, {
            //     // headers: { 'Content-Type': 'blob' },
            //     // responseType: 'blob'
            //     responseType: 'arraybuffer'
            // }).then(val => {
            //     console.log(val.data)
            //     console.log(val.data instanceof ArrayBuffer, '~~~~~~~~~');
            //     // let src = URL.createObjectURL(val.data);
            //     // document.getElementById('ImagePic').src = src;
            //     var dv = new DataView(val.data);
            //     console.log(dv, 'DataView', dv.getInt8(0), String.fromCharCode(dv.getInt8(0)));
            //     var buffer = [];
            //     var u8a = new Uint8Array(val.data);
            //     for (let i = 0; i < u8a.length; i++) {
            //         // console.log(String.fromCharCode(u8a[i]));
            //         buffer.push(String.fromCharCode(u8a[i]));
            //     }
            //     buffer = buffer.join('');
            //     let blob = new Blob([buffer]);
            //     let src = URL.createObjectURL(blob);
            //     src = 'data:image/png;base64,' + btoa(buffer);
            //     document.getElementById('ImagePic').src = src;
            //     // console.log(String.fromCharCode.apply(null, new Uint8Array(val.data)))
            // })

        };
        var b1 = new Blob(["zmz"], { type: "application/json" });
        let load = document.getElementById("load");
        load.onclick = function () {
            console.log(lust);
            lust();
        }

    }
</script>
<script src="./dist/vendors~main.bundle.js"></script>
<script src="./dist/main.bundle.js"></script>
<script src="./dist/zmz.bundle.js"></script>
<script src="./dist/main.bundle.js"></script>

</html>