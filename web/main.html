<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <script src="./tools/axios.min.js"></script>
    <style>
        .register {
            border: solid 2px pink;
            padding: 30px;
        }

        .loginctn {
            border: dashed 2px red;
            padding: 30px;
        }

        .updateCTn {
            border: dashed 2px green;
            padding: 30px;
        }

        .search {
            border: dashed 2px purple;
            padding: 30px;
            font-size: 24px;
        }
    </style>
</head>

<body>
    <h1 id="currentUser"></h1>
    <div class="register">
        <input type="text" value="" id="loginid" placeholder="id" />
        <input type="text" value="" id="loginpassword" placeholder="password" />
        <button id="register">register</button>
    </div>
    <button id="aaa">fuckyou</button>
    <button id="bbb">bbb</button>
    <button id="world">world</button>
    <div class="loginctn">
        <input type="text" value="lust" id="id" placeholder="id" />
        <input type="text" value="123456" id="password" placeholder="password" />
        <button id="login">login</button>
    </div>

    <div id="aaaaaaaa"></div>
    <div class="search">
        <input type="text" value="" id="searchname" placeholder="id" />
        <input type="text" value="" id="searchvalue" placeholder="password" />
        <button id="search">search</button>
    </div>
    <div class="updateCTn">
        <input type="file" multiple=true id="uperdaasd">
        <button id="getphoto">getphoto</button>

    </div>
    <img src="" id="ImagePic" />
</body>
<script>
    window.onload = function () {
        let register = document.getElementById("register");
        register.onclick = function () {
            axios.post("/api/register", {
                name: document.getElementById('loginid').value,
                password: document.getElementById('loginpassword').value,
            }).then(val => {
                console.log(val);
            })
        }
        let search = document.getElementById("search");
        search.onclick = function () {
            axios.post("/api/search", {
                searchname: document.getElementById('searchname').value,
                searchvalue: document.getElementById('searchvalue').value,
            }).then(val => {
                console.log(val);
            })
        }
        let world = document.getElementById("world");
        world.onclick = function () {
            axios.get("/api/world/hello").then(val => {
                console.log(val);
            })
        }
        let aaa = document.getElementById("aaa");
        aaa.onclick = function () {
            console.log("@@@@@@@@@@");
            axios.get("/api/fuckyou").then(val => {
                console.log(val);
            })
        }
        let bbb = document.getElementById("bbb");
        bbb.onclick = function () {
            axios.get("/api/doggy").then(val => {
                let { name, password } = val.data;
                document.getElementById("aaaaaaaa").innerHTML = `<h1>${name}, password${password}</h1>`;
            })
        }
        let login = document.getElementById("login");
        let loginfn = function () {
            axios.post("/api/login", {
                name: document.getElementById('id').value,
                password: document.getElementById('password').value,
            }).then(val => {
                let data = val.data;
                document.getElementById("currentUser").innerHTML = data.name + " adddate: " + data.addDate;
            })
        }
        login.onclick = loginfn();
        setTimeout(loginfn, 300);
        let uperdaasd = document.getElementById("uperdaasd");
        uperdaasd.onchange = function (e) {
            let file = e.target.files[0];
            console.log(e.target.files);
            let blob = new Blob([file]);
            let src = URL.createObjectURL(blob);
            document.getElementById('ImagePic').src = src;
            // var obj = new FormData();
            // console.log(e.target.files);
            // for (let value of e.target.files) {
            //     obj.append("photos", value);
            // }
            // axios.post('/api/upload', obj, {
            //     headers: { "Content-Type": "multipart/form-data" }
            // }).then(val => {
            //     uperdaasd.value = '';
            // })
        }
        let getphoto = document.getElementById("getphoto");
        getphoto.onclick = function () {
            axios.post("/api/world/getphoto").then(val => {
                // var raw = window.atob(val.data) //解析base64回图片原始的代码
                // var uint8Array = new Uint8Array(raw.length); //得到原始代码的长度创建强类型的uintArray
                // for (let i = 0; i < raw.length; i++) {
                //     uint8Array[i] = raw.charCodeAt(i); //把源代码编译成uinitcode。
                // }
                console.log(val.data);
                let blob = new Blob([val.data]);

                let src = URL.createObjectURL(blob);
                console.log(src);

                // let src = 'data:image/png;base64,' + val.data;
                document.getElementById('ImagePic').src = src;
            })
        };
        var b1 = new Blob(["zmz"], { type: "application/json" });


    }
</script>

</html>